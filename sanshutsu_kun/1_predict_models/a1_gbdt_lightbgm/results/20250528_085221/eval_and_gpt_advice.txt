--- 評価結果 ---
Accuracy: 0.7951
F1 Score: 0.4666
              precision    recall  f1-score   support

           0       0.82      0.93      0.87      8477
           1       0.62      0.37      0.47      2679

    accuracy                           0.80     11156
   macro avg       0.72      0.65      0.67     11156
weighted avg       0.78      0.80      0.78     11156


--- GPT-4.1からの改善アドバイス ---
LightGBMによる競馬の3着以内予測モデルの評価結果と各種グラフから、以下の改善アドバイスを提案します。

1. クラス不均衡への対策
- 混同行列より、3着以内（1）のデータ数が少なく、リコール（0.37）が低いです。
- サンプルウェイトやSMOTEなどのオーバーサンプリング、アンダーサンプリングを検討してください。
- LightGBMのis_unbalanceパラメータやscale_pos_weightも有効です。

2. モデルの閾値最適化
- PRカーブ、ROCカーブともに、閾値調整でPrecision-Recallバランスを最適化できます。
- 単なるデフォルト（0.5）ではなく、ビジネス目的に合わせた閾値調整を行いましょう。

3. 特徴量エンジニアリングの強化
- 精度は高いがリコールが低いので、3着以内馬の特徴をより抽出できる特徴量（例：直近レース成績、コース適性、騎手・厩舎情報、人気、馬体重変動など）を追加しましょう。

4. モデルの複雑さ調整と過学習対策
- 学習曲線を見ると、バリデーションとトレーニングで多少乖離があり、軽度の過学習が疑われます。
- early_stopping_roundsや正則化（lambda_l1, lambda_l2）、木の深さ(max_depth)の調整をしてください。

5. 評価指標の見直し
- F1やリコールを重視し、モデル選定・チューニングの際はAUCやPR-AUCも重視しましょう。

6. 外れ値・データ品質の確認
- 入力データの外れ値や誤記なども、リコール低下の原因となる場合があります。データクレンジングも併せて実施してください。

まとめ
クラス不均衡対策＋特徴量追加＋閾値調整が最優先です。それに加えて過学習対策と外れ値対応も行うことで、より3着以内馬を正しく拾えるモデルに改善できます。
