--- 評価結果 ---
Accuracy: 0.9053
F1 Score: 0.7697
              precision    recall  f1-score   support

           0       0.93      0.95      0.94      1901
           1       0.79      0.75      0.77       507

    accuracy                           0.91      2408
   macro avg       0.86      0.85      0.86      2408
weighted avg       0.90      0.91      0.90      2408


--- GPT-4.1からの改善アドバイス ---
LightGBMによる「競馬の3着以内に入る馬」の予測モデルについて、評価指標やグラフ（ROC曲線・PR曲線・学習曲線・混同行列）から、以下の改善アドバイスを簡潔にまとめます。

---

【モデル全体の評価】  
- 精度（Accuracy）は0.91と高いですが、3着以内（クラス1）のF1スコアは0.77とやや低めです。
- 混同行列を見ると、3着以内（1）の過小予測（FN）がやや多い傾向です（リコール0.75）。
- ROC、PR曲線ともにAUCは高そうですが、PR曲線のリコール高域でPrecisionが下がる傾向があります。

---

【改善アドバイス】

1. **クラス不均衡対策**
   - 3着以内（1）が少数派のため、サンプルウェイトやクラスバランス（is_unbalance, scale_pos_weightなど）をLightGBMで調整してください。
   - SMOTE等のオーバーサンプリングも検討可能です。

2. **リコール重視の最適閾値調整**
   - 現在の閾値0.5は精度寄りになりやすいです。ビジネス上リコール（的中率）重視なら、閾値を下げてリコール向上と引き換えにPrecisionを多少犠牲にするのも有効です。

3. **特徴量の追加・見直し**
   - モデルの学習曲線が収束している場合、データ量・特徴量の追加で性能向上が望めます。
   - 特徴量重要度を分析し、弱い特徴量の入れ替えや新規特徴量（馬場状態、脚質、直近成績、騎手・枠順・馬体重変化など）の追加を検討してください。

4. **アンサンブル・モデルの多様化**
   - LightGBM単体で頭打ちの場合、異なるモデル（XGBoost、CatBoost、深層学習等）とのアンサンブルやスタッキングも効果的です。

5. **過学習・汎化性能の確認**
   - 学習曲線に大きなギャップがあれば過学習の可能性あり。early_stopping_roundsや正則化パラメータ（lambda_l1, lambda_l2等）の調整を行ってください。

6. **評価指標の多角化**
   - F1やAUCだけでなく、ビジネス上の指標（例えば3着馬検出のリコール、馬券シミュレーション等）も併用して最適化を目指しましょう。

---

【まとめ】
→ クラス不均衡対策と最適閾値の再調整、特徴量の拡充がまず有効です。さらに学習曲線・混同行列・PR曲線を参考に、目的に応じたリコール/Precisionバランスを調整し、必要なら他モデル・アンサンブルも検討してください。

---

もし具体的なグラフ画像の数値や形状について個別にアドバイスが欲しい場合は、その旨を追記してください。
